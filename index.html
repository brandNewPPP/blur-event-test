<!DOCTYPE html>
<html>
<body>
<h1>テスト</h1>

<!-- スタイルを追加してテキストを赤色に -->
<span id="fname" style="color: red;"></span>

<script>
function getCurrentTime() {
  return new Date().toLocaleTimeString();
}

// ページがフォーカスを失ったときにアラートを表示し、時間を含める
window.addEventListener("blur", function() {
  const time = getCurrentTime();
  alert("サイトから離れました - " + time);
});

// ページにフォーカスが戻ったときに<span>要素にメッセージと時間を表示
window.addEventListener("focus", function() {
  const time = getCurrentTime();
  document.getElementById("fname").textContent = "フォーカスが戻りました - " + time;
});

// タブやブラウザが閉じられる前に実行
window.addEventListener("beforeunload", function(e) {
  const time = getCurrentTime();
  const message = "ページを離れようとしています　- "　 + time;
  e.returnValue = message; // 一部のブラウザでは、この値が確認ダイアログに表示されます。
  return message; // 古いブラウザのサポート
});
</script>

</body>
</html>
